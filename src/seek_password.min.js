"use strict";function hex_password(e,t){var n=sha512.hmac(t,e),s=sha512.hmac(n.slice(0,n.length/2),n),r=sha512.hmac(n.slice(-n.length/2),n),o=s.split(""),a=r.split("");console.assert(a.length===o.length,"sha512长度错误！");for(var c=0;c<o.length;++c)if(isNaN(o[c])){var l="maytheforcebewithyou";l.search(a[c])>-1&&(o[c]=o[c].toUpperCase())}return o.join("")}function seek_password(e,t,n,s){var r="abcdefghijklmnopqrstuvwxyz".split(""),o="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),a="0123456789".split(""),c="~*-+()!@#$^&".split(""),l=r.concat(a);1==parseInt(n)&&(l=l.concat(c)),1==parseInt(s)&&(l=l.concat(o));for(var i=0;i<=e.length-t;++i){var u=e.slice(i,i+parseInt(t)).split(""),p=0,h=u.map(function(e){return p=(p+e.charCodeAt())%l.length}),d=h.map(function(e){return l[e]}),g=[!1,!1,!1,!1];if(d.forEach(function(e){g[0]=g[0]||r.includes(e),g[1]=g[1]||o.includes(e),g[2]=g[2]||a.includes(e),g[3]=g[3]||c.includes(e)}),-1==parseInt(s)&&(g[1]=!0),-1==parseInt(n)&&(g[3]=!0),!g.includes(!1))return d.join("")}return""}function get_select_option(e){var t=document.getElementById(e),n=t.selectedIndex;return[t.options[n].value,t.options[n].text]}function generate_password(){var e=document.getElementById("pwd").value,t=document.getElementById("key").value,n=get_select_option("rule_of_punctuation"),s=get_select_option("rule_of_letter"),r=get_select_option("pwd_length");if(e&&t){var o=hex_password(e,t);console.assert(128===o.length,"hash长度不是128位！");return seek_password(o,r[0],n[0],s[0])}}
